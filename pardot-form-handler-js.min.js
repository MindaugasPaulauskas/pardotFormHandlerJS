/*! pardotFormHandlerJS v.0.1.1 | (c) 2024 Mindaugas Paulauskas | https://github.com/MindaugasPaulauskas/pardotFormHandlerJS/LICENSE */
!function(e){function r(t,e){var s=this,r=(this.form=t,this.settings=JSON.parse(JSON.stringify(S)),this.setSettings=function(e){for(key in e)void 0!==s.settings[key]&&(s.settings[key]=e[key]);return s},this.setSettings(e),this.currentCallbackId=!1,this.callbacks={onBeforeSubmit:function(e,t){return!0},onSubmit:function(e){},onCancel:function(e){},onSuccess:function(e){},onError:function(e){},onComplete:function(e){}},this.onBeforeSubmit=function(r){return s.callbacks.onBeforeSubmit=function(e,t){return r(e,t)},s},this.onSubmit=function(t){return s.callbacks.onSubmit=function(e){return t(e)},s},this.onCancel=function(t){return s.callbacks.onCancel=function(e){return t(e)},s},this.onSuccess=function(t){return s.callbacks.onSuccess=function(e){return t(e)},s},this.onError=function(t){return s.callbacks.onError=function(e){return t(e)},s},this.onComplete=function(t){return s.callbacks.onComplete=function(e){return t(e)},s},this.destroy=function(){return s.form.removeEventListener("submit",r),s.form.removeEventListener(a,n),s.form.removeEventListener(c,o),F(s.currentCallbackId,"form destroyed"),s},function(e){var t,r,n,o=e.target;u(o)&&(e.preventDefault(),e=o.getAttribute("action"),!1!==s.settings.actionUrl&&(e=s.settings.actionUrl),t=m(o),!1!==(n=s.callbacks.onBeforeSubmit(t,o)))&&(void 0!==n&&!0!==n&&(t=n),!1!==s.currentCallbackId&&x(s.currentCallbackId),n=d(t),r=h(o),E[r]={id:r,formDom:o,pardotForm:s,url:e=e+"?callback="+r+"&"+n,values:t,scriptDom:!1},s.currentCallbackId=r,n=document.createElement("script"),document.body.appendChild(n),n.src=e,E[r].scriptDom=n,C(o),v(o,s.settings),s.callbacks.onSubmit({submit:E[r],result:!1}),s.settings.timeout)&&setTimeout(function(){M(E[r])},s.settings.timeout)}),n=(t.addEventListener("submit",r),function(e){k(t,e.detail),y(t),s.callbacks.onError(e.detail),s.currentCallbackId=!1,s.callbacks.onComplete(e.detail)}),o=(t.addEventListener(a,n),function(e){k(t,e.detail),y(t),s.callbacks.onSuccess(e.detail),s.currentCallbackId=!1,s.callbacks.onComplete(e.detail)});t.addEventListener(c,o)}var t="pardotFormHandlerJS",a=t+".Error",c=t+".Success",n="pardot-form-handler-js--",o=n+"jsonp-callback",s=n+"overlay",f=n+"message",g=f+"-container",n=n+"loader-spin",l=function(e){for(var t=0,r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t},u=function(e){return null!==e&&"object"==typeof e&&"FORM"===e.nodeName&&void 0!==e.elements},m=function(e){function t(e,t,r){switch(typeof e[t]){case"undefined":e[t]=r;break;case"string":e[t]=[e[t]],e[t].push(r);break;case"object":e[t].push(r)}return e}var r,n,o,s={};if(!u(e))return!1;for(r=0;r<e.elements.length;r++)if((o=e.elements[r]).name&&!o.disabled)switch(o.type){case"submit":case"button":case"reset":case"file":break;case"select-multiple":for(n=0;n<e.elements[r].options.length;n++)o.options[n].selected&&(s=t(s,o.name,o.options[n].value));break;case"checkbox":case"radio":o.checked&&(s=t(s,o.name,o.value));break;default:s=t(s,o.name,o.value)}return s},d=function(e){function t(e,t,r){return t=encodeURIComponent(t),t=(t+="=")+encodeURIComponent(r),e[e.length]=t,e}var r,n=[];for(r in e)if("string"==typeof e[r])n=t(n,r,e[r]);else if("object"==typeof e[r])for(i=0;i<e[r].length;i++)n=t(n,r,e[r][i]);return n.join("&").replace(/%20/g,"+")},b=function(e){return d(m(e))},p=function(e){for(var t="",r=0;r<e;r++)t+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(Math.floor(36*Math.random()));return t},h=function(e){var t=[o,(new Date).getTime().toString(36),p(8),l(b(e)).toString(35).replace("-","z")].join("-");return t=void 0!==E[t]?h(e):t},v=function(e,t){var r;!0===t.showLoadingOverlay&&((r=document.createElement("div")).className=s,r.style.position="absolute",r.style.top="0",r.style.bottom="0",r.style.left="0",r.style.right="0",r.style.background=t.loadingOverlayBgColor,r.innerHTML=t.loadingOverlayInnerHtml,e.appendChild(r))},y=function(e){for(var t=e.querySelectorAll("."+s),r=0;r<t.length;r++)t[r].parentNode.removeChild(t[r])},k=function(e,t){var r=t.submit.pardotForm.settings,n=!1,o=r.messageErrorBgColor,s=!1,a="#495467",i="#fff",c=r.messagePadding,l=r.messageBorderRadius,u=r.messageMargin,m=f,d=!1;!0===r.showFormMessaging&&(!0===t.result.errors||"true"===t.result.errors?(n=!0,m+=" errors",a=o,i=r.messageErrorTxtColor):(m+=" success",a=r.messageSuccessBgColor,i=r.messageSuccessTxtColor,s=r.successMessage),"string"==typeof t.result.errorMessage?s=(s="~~~"===(s=t.result.errorMessage).substr(s.length-3)?s.substr(0,s.length-3):s).replaceAll("~~~","<br>"):!0===n&&(s=r.defaultErrorMessage),s&&((d=document.createElement("div")).className=m,d.style.background=a,d.style.padding=c,d.style.borderRadius=l,d.style.margin=u,d.style.color=i,d.innerHTML=s,(o=null===(o=e.querySelector("."+g))?e:o).insertBefore(d,o.firstChild)),!1===n)&&!0===t.submit.pardotForm.settings.resetFormAfterSuccess&&t.submit.formDom.reset()},C=function(e,t){for(var r=e.querySelectorAll("."+f),n=0;n<r.length;n++)r[n].parentNode.removeChild(r[n])},S={actionUrl:!1,successMessage:"Success! Thank you for submission.",resetFormAfterSuccess:!0,defaultErrorMessage:"Submission failed! Please enter required information.",timeout:5e3,timeoutMessage:"Ops! Request has timed out. Please try again later.",showLoadingOverlay:!0,loadingOverlayBgColor:"rgba(0,0,0,0.1)",loadingOverlayInnerHtml:"<style>@keyframes "+n+"{100%{transform:rotate(360deg);}}</style><div style='position:absolute;top:50%;left:50%;width:50px;height:50px;box-sizing:border-box;margin:-25px 0 0 -25px;border:#fff 4px solid;border-radius:25px;animation:"+n+" 3s linear infinite;border-color:#666 transparent transparent;'></div>",showFormMessaging:!0,messageErrorBgColor:"#dd1a21",messageErrorTxtColor:"#fff",messageSuccessBgColor:"#147f3c",messageSuccessTxtColor:"#fff",messagePadding:"4px",messageMargin:"0 0 4px",messageBorderRadius:"4px"},E=[],M=function(e){var t,e=w(e);e&&(t={submit:E[e],result:{errors:!0}},"string"==typeof E[e].pardotForm.settings.timeoutMessage&&(t.result.errorMessage=E[e].pardotForm.settings.timeoutMessage),k(E[e].formDom,t),y(E[e].formDom),E[e].pardotForm.callbacks.onError(t),E[e].pardotForm.callbacks.onComplete(t),F(e,"timed out"))},x=function(e){e=w(e);e&&(E[e].pardotForm.callbacks.onCancel({submit:E[e],result:!1}),F(e,"canceled"))},F=function(e,t){var r,e=w(e);e&&((r=E[e].scriptDom).parentNode.removeChild(r),E[e]=t)},w=function(e){return void 0!==(e="string"==typeof e?E[e]:e)&&"string"==typeof e.id&&e.id},n={setupForm(e,t){if(u(e))return new r(e,t)},callback(e){var t,r=c;if(void 0!==e){void 0===e.errors||!0!==e.errors&&"true"!==e.errors||(r=a);var n,o=!1;if("string"==typeof e.callback)o=e.callback;else{if(void 0===(n=document.currentScript))return;n=n.getAttribute("src"),n=new URL(n),o=new URLSearchParams(n.search).get("callback")}o&&E[o]&&(n=E[o].formDom)&&(t=E[o],n.dispatchEvent(new CustomEvent(r,{bubbles:!0,detail:{submit:t,result:e}})),F(o,r))}}};"object"==typeof e&&(e[t]=n)}(this);
